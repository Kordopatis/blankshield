<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>blankshield &amp; Reverse tabnabbing attacks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

  <style>
    /*! normalize.css v3.0.2 | MIT License | git.io/normalize */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}
    /*! Skeleton V2.0.4 | MIT license*/.container{position:relative;width:100%;max-width:960px;margin:0 auto;padding:0 20px;box-sizing:border-box}.column,.columns{width:100%;float:left;box-sizing:border-box}@media (min-width:400px){.container{width:85%;padding:0}}@media (min-width:550px){.container{width:80%}.column,.columns{margin-left:4%}.column:first-child,.columns:first-child{margin-left:0}.one.column,.one.columns{width:4.66666666667%}.two.columns{width:13.3333333333%}.three.columns{width:22%}.four.columns{width:30.6666666667%}.five.columns{width:39.3333333333%}.six.columns{width:48%}.seven.columns{width:56.6666666667%}.eight.columns{width:65.3333333333%}.nine.columns{width:74%}.ten.columns{width:82.6666666667%}.eleven.columns{width:91.3333333333%}.twelve.columns{width:100%;margin-left:0}.one-third.column{width:30.6666666667%}.two-thirds.column{width:65.3333333333%}.one-half.column{width:48%}.offset-by-one.column,.offset-by-one.columns{margin-left:8.66666666667%}.offset-by-two.column,.offset-by-two.columns{margin-left:17.3333333333%}.offset-by-three.column,.offset-by-three.columns{margin-left:26%}.offset-by-four.column,.offset-by-four.columns{margin-left:34.6666666667%}.offset-by-five.column,.offset-by-five.columns{margin-left:43.3333333333%}.offset-by-six.column,.offset-by-six.columns{margin-left:52%}.offset-by-seven.column,.offset-by-seven.columns{margin-left:60.6666666667%}.offset-by-eight.column,.offset-by-eight.columns{margin-left:69.3333333333%}.offset-by-nine.column,.offset-by-nine.columns{margin-left:78%}.offset-by-ten.column,.offset-by-ten.columns{margin-left:86.6666666667%}.offset-by-eleven.column,.offset-by-eleven.columns{margin-left:95.3333333333%}.offset-by-one-third.column,.offset-by-one-third.columns{margin-left:34.6666666667%}.offset-by-two-thirds.column,.offset-by-two-thirds.columns{margin-left:69.3333333333%}.offset-by-one-half.column,.offset-by-one-half.columns{margin-left:52%}}html{font-size:62.5%}body{font-size:1.5em;line-height:1.6;font-weight:400;font-family:Raleway,HelveticaNeue,"Helvetica Neue",Helvetica,Arial,sans-serif;color:#222}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:2rem;font-weight:300}h1{font-size:4rem;line-height:1.2;letter-spacing:-.1rem}h2{font-size:3.6rem;line-height:1.25;letter-spacing:-.1rem}h3{font-size:3rem;line-height:1.3;letter-spacing:-.1rem}h4{font-size:2.4rem;line-height:1.35;letter-spacing:-.08rem}h5{font-size:1.8rem;line-height:1.5;letter-spacing:-.05rem}h6{font-size:1.5rem;line-height:1.6;letter-spacing:0}@media (min-width:550px){h1{font-size:5rem}h2{font-size:4.2rem}h3{font-size:3.6rem}h4{font-size:3rem}h5{font-size:2.4rem}h6{font-size:1.5rem}}p{margin-top:0}a{color:#1EAEDB}a:hover{color:#0FA0CE}.button,button,input[type=button],input[type=reset],input[type=submit]{display:inline-block;height:38px;padding:0 30px;color:#555;text-align:center;font-size:11px;font-weight:600;line-height:38px;letter-spacing:.1rem;text-transform:uppercase;text-decoration:none;white-space:nowrap;background-color:transparent;border-radius:4px;border:1px solid #bbb;cursor:pointer;box-sizing:border-box}.button:focus,.button:hover,button:focus,button:hover,input[type=button]:focus,input[type=button]:hover,input[type=reset]:focus,input[type=reset]:hover,input[type=submit]:focus,input[type=submit]:hover{color:#333;border-color:#888;outline:0}.button.button-primary,button.button-primary,input[type=button].button-primary,input[type=reset].button-primary,input[type=submit].button-primary{color:#FFF;background-color:#33C3F0;border-color:#33C3F0}.button.button-primary:focus,.button.button-primary:hover,button.button-primary:focus,button.button-primary:hover,input[type=button].button-primary:focus,input[type=button].button-primary:hover,input[type=reset].button-primary:focus,input[type=reset].button-primary:hover,input[type=submit].button-primary:focus,input[type=submit].button-primary:hover{color:#FFF;background-color:#1EAEDB;border-color:#1EAEDB}input[type=email],input[type=number],input[type=password],input[type=search],input[type=tel],input[type=text],input[type=url],select,textarea{height:38px;padding:6px 10px;background-color:#fff;border:1px solid #D1D1D1;border-radius:4px;box-shadow:none;box-sizing:border-box}input[type=email],input[type=number],input[type=password],input[type=search],input[type=tel],input[type=text],input[type=url],textarea{-webkit-appearance:none;-moz-appearance:none;appearance:none}textarea{min-height:65px;padding-top:6px;padding-bottom:6px}input[type=email]:focus,input[type=number]:focus,input[type=password]:focus,input[type=search]:focus,input[type=tel]:focus,input[type=text]:focus,input[type=url]:focus,select:focus,textarea:focus{border:1px solid #33C3F0;outline:0}label,legend{display:block;margin-bottom:.5rem;font-weight:600}fieldset{padding:0;border-width:0}input[type=checkbox],input[type=radio]{display:inline}label>.label-body{display:inline-block;margin-left:.5rem;font-weight:400}ul{list-style:circle inside}ol{list-style:decimal inside}ol,ul{padding-left:0;margin-top:0}ol ol,ol ul,ul ol,ul ul{margin:1.5rem 0 1.5rem 3rem;font-size:90%}li{margin-bottom:1rem}code{padding:.2rem .5rem;margin:0 .2rem;font-size:90%;white-space:nowrap;background:#F1F1F1;border:1px solid #E1E1E1;border-radius:4px}pre>code{display:block;padding:1rem 1.5rem;white-space:pre}td,th{padding:12px 15px;text-align:left;border-bottom:1px solid #E1E1E1}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}.button,button{margin-bottom:1rem}fieldset,input,select,textarea{margin-bottom:1.5rem}blockquote,dl,figure,form,ol,p,pre,table,ul{margin-bottom:2.5rem}.u-full-width{width:100%;box-sizing:border-box}.u-max-full-width{max-width:100%;box-sizing:border-box}.u-pull-right{float:right}.u-pull-left{float:left}hr{margin-top:3rem;margin-bottom:3.5rem;border-width:0;border-top:1px solid #E1E1E1}.container:after,.row:after,.u-cf{content:"";display:table;clear:both}

    /* Custom styles */
    h1 {
      text-transform: uppercase;
      font-size: 3.0rem;
      text-align: center;
      padding-bottom: 20px;
    }
    h2 {
      font-size: 2.0rem;
      color: #666;
    }
    .bar {
      border: 0;
      border-radius: 0;
      height: auto;
      white-space: normal;
      line-height: 28px;
      width: 100%;
      display: block;
      margin-bottom: 0;
      padding: 15px 30px;
    }
    .columns {
      border-radius: 4px;
      font-size: 1rem;
      margin-bottom: .75rem;
      font-weight: 600;
      letter-spacing: .1rem;
      line-height: 20px;
      padding: 20px;
    }
    .loggedin {
      color: #AAA;
    }
    .profile {
      text-align: center;
      background: #EEE;
      text-transform: uppercase;
    }
    .profile span {
      color: #AAA;
    }
    .profile p {
      margin-bottom: 0;
    }
    .post {
      padding-top: 0px;
      text-align: left;
      font-size: 1.2rem;
    }
    .explanation {
      font-size: 1.2rem;
      color: #999;
    }
    form .columns {
      padding: 0;
    }
    label {
      text-align: left;
    }
    @media (min-width: 550px) {
      .profile {
        min-height: 150px;
      }
      .loggedin {
        text-align: right;
      }
    }
    @media (max-width: 550px) {
      .nav {
        padding-bottom: 0;
      }
    }
  </style>
</head>
<body>
  <a id="brief" class="bar button button-primary" target="_blank" href="http://www.danielstjules.com/github/blankshield-demo-attack.html">
    This is a fake static HTML bug tracker setup to visualize how users may be
    vulnerable to a reverse tabnabbing attack. To skip the fluff, click on this
    bar to see an example of its execution. Or scroll to the bottom to read more.
  </a>
  <div class="container">
    <div class="row">
      <div class="six columns nav">
        <a href="http://www.github.com/danielstjules/blankshield">Dashboard</a> |
        <a href="http://www.github.com/danielstjules/blankshield">Issues</a> |
        <a href="http://www.github.com/danielstjules/blankshield">Profile</a>
      </div>
      <div class="six columns loggedin">
        You are logged in as Admin
      </div>
    </div>
    <h1>blankshield &amp; Reverse tabnabbing attacks</h1>
    <div class="row">
      <div class="three columns profile">
        <b>Daniel St. Jules</b>
        <p>
          <span>Posts: 3</span><br>
          <a href="https://www.github.com/danielstjules">GitHub</a>
        </p>
      </div>
      <div class="nine columns post">
        <h2>A dummy bug report vulnerable to the attack</h2>
        <p>
          This is not a real issue tracker. But in this scenario, a user is
          requesting that you visit some page in hopes of acquiring your
          credentials. Unlike other phishing attacks, the opened link is not
          the final destination. To see how, click
          <a target="_blank" href="http://www.danielstjules.com/github/blankshield-demo-attack.html">this link</a>
          without using a modifier key or context menu. After being opened in a
          new tab due to its use of target="_blank", it will redirect this page.
          <a href="https://www.github.com/danielstjules/blankshield">blankshield</a>
          is a JavaScript library that helps mitigate the attack. For example,
          <a id="protected" target="_blank" href="http://www.danielstjules.com/github/blankshield-demo-attack.html">clicking here</a>
          will not cause this tab to redirect, and is thus not vulnerable.
        </p>
      </div>
    </div>
    <form>
      <div class="row">
        <div class="six columns">
          <label for="modify">Set priority</label>
          <select class="u-full-width" id="modify">
            <option value="low">Low</option>
            <option value="normal">Normal</option>
            <option value="high" selected="true">High</option>
          </select>
        </div>
        <div class="six columns">
          <label for="modify">Update status</label>
          <select class="u-full-width" id="modify">
            <option value="open">Open</option>
            <option value="blocked">Blocked</option>
            <option value="closed">Closed</option>
          </select>
        </div>
      </div>
      <div class="row">
        <div class="twelve columns">
          <label for="exampleMessage">Message</label>
          <textarea class="u-full-width" placeholder="Hi Daniel …" id="exampleMessage"></textarea>
          <input class="button-primary" type="submit" value="Submit">
          <hr>
          <p class="explanation">
            The first link in the post above is vulnerable to
            <a href="https://sites.google.com/site/bughunteruniversity/nonvuln/phishing-with-window-opener">reverse tabnabbing</a>
            since it uses target="_blank". Try clicking the link normally, or
            with a modifier key (shift, meta, etc), but without using a right
            click context menu. You'll be taken to a new tab, and this page will
            redirect to a fake attacker's "phishing page". The new tab is able to
            redirect this page using window.opener.location. The second link,
            however, is protected by using blankshield(), the function provided
            by <a href="https://www.github.com/danielstjules/blankshield">this library</a>.
            This is all just a small demo of a potential attack on a bug tracking
            app, to help convey its impact.
          </p>
          <p class="explanation">
            The following table outlines the scope of affected browsers:
          </p>

          <table class="explanation">
            <tr>
              <td>Browser</td>
              <td>Click</td>
              <td>Shift + click</td>
              <td>Meta/Ctrl + click</td>
            </tr>
            <tr>
              <td>Chrome 40</td>
              <td>x</td>
              <td>x</td>
              <td>x</td>
            </tr>
            <tr>
              <td>Firefox 34</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>Opera 26</td>
              <td>x</td>
              <td>x</td>
              <td>x</td>
            </tr>
            <tr>
              <td>Safari 7</td>
              <td>x</td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>IE6...11</td>
              <td colspan="3"><sup>[1]</sup></td>
            </tr>
          </table>

          <sup>[1]</sup> IE is not vulnerable to the attack by default. However,
          this can change depending on security zone settings.
        </div>
      </div>
    </form>
  </div>
  <a class="bar button button-primary" href="http://www.github.com/danielstjules/blankshield">
    Click here to check out blankshield on GitHub and prevent this sort of attack
  </a>
  <script>
  /**
   * blankshield - Prevent reverse tabnabbing phishing attacks caused by _blank
   *
   * @version   0.1.0
   * @link      https://github.com/danielstjules/blankshield
   * @author    Daniel St. Jules <danielst.jules@gmail.com>
   * @license   MIT
   */
  !function(e){"use strict";function t(e,t,n){if(e.addEventListenerListener)return e.addEventListenerListener(t,n,!1);var i="on"+t;e.attachEvent?e.attachEvent(i,n):e[i]?(prevListener=e[i],e[i]=function(){n(),prevListener()}):e[i]=n}var n=function(e){var t,n,i,r;e=e||window.event,t=e.target||e.srcElement,n=t.getAttribute("href"),n&&(i=e.ctrlKey||e.shiftKey||e.metaKey,(i||"_blank"===t.getAttribute("target"))&&(r=window.open(n),r.opener=null,e.preventDefault?e.preventDefault():e.returnValue=!1))},i=function(e){if("undefined"==typeof e.length)t(e,"click",n);else if("string"!=typeof e&&!(e instanceof String))for(var i=0;i<e.length;i++)t(e[i],"click",n)};"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports?module.exports=i:exports.blankshield=i),"function"==typeof define&&"object"==typeof define.amd&&define("blankshield",[],function(){return i}),e.blankshield=i}(this);
  </script>
  <script>
    function isFF() {
      return navigator.userAgent.toLowerCase().indexOf('firefox') !== -1;
    }

    function isIE() {
      return navigator.userAgent.indexOf('MSIE ') !== -1;
    }

    if (isFF() || isIE()) {
      var brief = document.getElementById('brief');
      document.getElementById('brief').innerHTML = "You are not using a " +
        "vulnerable browser. Scroll down to learn more about the attack, or " +
        "click here to go to the GitHub page";
      brief.setAttribute("href", "http://www.github.com/danielstjules/blankshield");
    }

    blankshield(document.getElementById('protected'));
  </script>
</body>
</html>
