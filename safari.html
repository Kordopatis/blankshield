<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Test Safari</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
  <p>
    <a target="_blank" href="http://danielstjules.com/github/blankshield-safari-popup.html">Not Safe</a>
  </p>

  <p>Click the link and view console logs.</p>

  <script>
    var anchor = document.getElementsByTagName('a')[0];
    anchor.addEventListener('click', function(e) {
      console.log(Date.now(), 'Before tab open');
      var tab = window.open(anchor.getAttribute('href'));
      console.log(Date.now(), 'After tab open');
      tab.opener = null;
      console.log(Date.now(), 'After setting opener to null');

      e.preventDefault();
      return false;
    });
  </script>
</body>
</html>
